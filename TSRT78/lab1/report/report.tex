\documentclass{IEEEtran}
\usepackage{listings}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}
\title{Lab1 --- Fundamental Signal Processing}
\author{David Pop, Malcolm Vigren}

\maketitle

\section{Introduction}
This report describes a laboratory performed at Link√∂ping university as an
asignment in a course in digital signal processing. In the context of
digital signal processing, it is possible to create a model of a given
signal that can be used later on to recreate the original signal to some
extent. These models can usually be described with a number of parameters
that is much lower that the number of samples in the actual signal. Because
the recreated signal would just be an approximation of the original signal
it is important to analyze how well the model describes the signal as well
as what can be done to improve the model. The purpose of the laboratory was
to experiment with how this might be done in practice.

The laboratory consisted of three parts, each with different tasks and
goals.

The first assignment was to model the sound of a person whistling and the
try to recreate the sound from the model. Focus lay on analyzing the purity
of the recreated signal.

The goal of the second part was to create models for the sound of spoken
vowels and then recreate the sounds. The main task here was to estimate
the model order needed for each sound and the validate the resulting
sounds against the original sounds.

The last part of the laboratory consisted of recording and modeling of
spoken language in a similar way as it would be done in GSM communication.
The focus of this task lay on implementing the modeling method and analyze
the results.

\section{Assignment 1 --- Whistle}
Asignment 1 consisted of recording the sound of a person whistling and then
modeling it.

\subsection{Theory}
The sound of whistling is relatively simple and pure sound that resembles
a sine wave. Therefore it is expected to be possible to model this sound
with a simple model with only a small number of parameters. Such a model
could be for example an auto-regressive model of order 2. An AR(2) model
can be described mathematically as follows,

\begin{equation}
  \label{1:ar2}
  y(t) + a_1 y(t-1) + a_2 y(t-2) = e(t) \quad .
\end{equation}

In equation \ref{1:ar2}, $y$ is the signal generated by the model, $e$ is
simply white noise and $a_1, a_2$ are the parameters that describe the
model. This means that the signal can be generated from the previous two
generated sample and white noise:

\begin{equation}
  \label{1:ar2y}
  y(t) = e(t) - a_1 y(t-1) - a_2 y(t-2)\quad .
\end{equation}

The parameters $a_1$ and $a_2$ are describing the behaviour of the system
while the purpose of $e$ is to input energy in to the system. Any signal
$e$ that has a constant power spectrum can be used to generate the desired
signal as described by \textit{Wold's theorem}\cite{signalproc}. In this
case though, the signal of the whistling sound resembles white noise more
than the other alternatives. Therefore, white noise should be used to
recreate the signal as it is expected to give the best results.

It is expected that the generated signal from the model is not exactly
equal to the original one because the model is described with only a small
number of parameters. Thus the recreated signal is expected to be just an
approximation of the original one. For this reason it is of interest to
try to find the model parameters in such a way that generates a signal
that is as close as possible to the desired one. Given the original signal
$s$ and the generated signal $y$, it is desired to find the set of
parameters $\theta$ so that the loss function
\begin{equation}
  \label{1:loss}
  V(\theta)  = \frac{1}{N}\sum_{t=1}^{N}(s(t) - y(t; \theta))^2
\end{equation}
to be as small as possible. For example, in the case of equation \ref{1:ar2},
$\theta$ would consist of the parameters $a_1$ and $a_2$. By defining
the regression vector
\begin{equation}
  \phi^T(t) = (y(t-1), y(t-2), ... , y(t-N)) \quad ,
\end{equation}
equation \ref{1:ar2y} can be rewritten as
\begin{equation}
  y(t) = \phi^T(t)\cdot\theta + e(t) \quad .
\end{equation}

In these equations $e(t)$ is considered to be white noise, so when
generating a signal from the model it it impossible to know beforehand
what values $e(t)$ will take. Therefore for the purpose of estimating
the model parameters $e(t)$ can be set to its mean value which in this
case is $0$. Therefore
\begin{equation}
  \label{1:esty}
  y(t) = \phi^T(t)\cdot\theta \quad .
\end{equation}

By defining the $N\times1$ vector $Y_N$ and the $N\times n$ vector
$\Phi_N$ as following,

\begin{equation}
  Y_N =
  \begin{pmatrix}
    y(1) \\ y(2) \\ \vdots \\ y(N)
  \end{pmatrix}
  \quad
  \textnormal{and}
  \quad
  \Phi_N =
  \begin{pmatrix}
    \phi^T(1) \\ \phi^T(2) \\ \vdots \\ \phi^T(N)
  \end{pmatrix}
  \quad ,
\end{equation}
equation \ref{1:esty} can be written in vector notation as
\begin{equation}
  Y_N = \Phi_N\theta \quad .
\end{equation}

According to \cite{signalproc} this equation can be treated as a least
squares problem and be solved through the following system of normal
equations,

\begin{equation}
  \Phi_N^T\Phi_N\theta = \Phi_N^T Y_N \quad ,
\end{equation}

where the solution is given by

\begin{equation}
  \hat{\theta}_N = \left( \frac{1}{N}\Phi_N^T\Phi_N \right)^{-1}
                   \left( \frac{1}{N}\Phi_N^T Y_N \right)
  \quad .
\end{equation}

The solution $\hat{\theta}_N$ is the desired set of model parameters
that minimizes the loss function defined in \ref{1:loss} for a signal
of length $N$. These can be later used to generate a signal that
resembles sound of whistling.

There are multiple ways to check the purity of the generated signal which
means analysing how close to a pure whistle the resulting signal is.

Since it is expected that the signal should have most of its energy
concentrated around a certain frequency, one way to check its purity
is to look at its harmonic distortion. This measure is defined as

\begin{equation}
  \label{1:hdist}
  1 - \frac{E_{\textnormal{dom. freq.}}}{E_{\textnormal{tot.}}}\quad .
\end{equation}
$E_{\textnormal{dom. freq.}}$ is in this case the energy contained in
a small frequency band centered around the signal's dominant frequency
and $E_{\textnormal{tot.}}$ is the signal's total energy. It is desired
that most of the signal's energy is concentrated around its dominant
frequency so a smaller measure of harmonic distortion means that the
signal is more pure.

Another way to measure the purity of the signal is to look at the poles
of the estimated model. The closer these poles are to the unit circle
the more pure the signal is.

\subsection{Method}
\subsection{Results}
\subsection{Discussion}

\section{Assignment 2 --- Vowel}

\subsection{Theory}
\subsection{Method}
\subsection{Results}
\subsection{Discussion}

\section{Assignment 3 --- GSM}

\subsection{Theory}
\subsection{Method}
\subsection{Results}
\subsection{Discussion}

\section{Conclusion}

\newpage
\begin{appendices}
    \section{Matlab code}
\end{appendices}

\begin{thebibliography}{9}

\bibitem{signalproc}
  Gustafsson, Fredrik,
  \textit{Signal processing},
  Studentlitteratur, Lund,
  2010.

\end{thebibliography}

\end{document}
