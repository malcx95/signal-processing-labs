\documentclass{IEEEtran}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{%
    aboveskip=3mm, belowskip=3mm,
    showstringspaces=false,
    columns=flexible,
    basicstyle={\small\ttfamily},
    numbers=none,
    numberstyle=\tiny\color{red},
    keywordstyle=\color{blue},
    commentstyle=\color{dkgreen},
    stringstyle=\color{mauve},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=3
}

\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\val}[1]{#1_{\text{val}}}
\newcommand{\est}[1]{#1_{\text{est}}}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}
\title{Lab1 --- Fundamental Signal Processing}

\maketitle

\section{Introduction}
This report describes a laboratory performed at Link√∂ping university as an
asignment in a course in digital signal processing. In the context of
digital signal processing, it is possible to create a model of a given
signal that can be used later on to recreate the original signal to some
extent. These models can usually be described with a number of parameters
that is much lower that the number of samples in the actual signal. Because
the recreated signal would just be an approximation of the original signal
it is important to analyze how well the model describes the signal as well
as what can be done to improve the model. The purpose of the laboratory was
to experiment with how this might be done in practice.

The laboratory consisted of three parts, each with different tasks and
goals.

The first assignment was to model the sound of a person whistling and the
try to recreate the sound from the model. Focus lay on analyzing the purity
of the recreated signal.

The goal of the second part was to create models for the sound of spoken
vowels and then recreate the sounds. The main task here was to estimate
the model order needed for each sound and the validate the resulting
sounds against the original sounds.

The last part of the laboratory consisted of recording and modeling of
spoken language in a similar way as it would be done in GSM communication.
The focus of this task lay on implementing the modeling method and analyze
the results.

\section{Assignment 1 --- Whistle}

\subsection{Theory}
\label{sec:whistletheory}

\subsection{Method}
\subsection{Results}
\subsection{Discussion}

\section{Assignment 2 --- Vowel}

In this assignment, the sound of the vowels `a' and `o' were to be
modeled, using AR-models of suitable orders. The models were then
simulated using a suitable input signal.

\subsection{Theory}

In this section, the theoretical background behind the vowel assignment is 
explained.

\subsubsection{Model order estimation}

In order to estimate the model order, \textit{cross validation} is used.
Here, the observed data $y(t)$ is split into two
parts, the \textit{estimation data} $\est{y}(t)$ containing samples $1,
2,\ldots,N_1$, and
the \textit{validation data} $\val{y}(t)$ containing samples $N_1 + 1, N_1 + 2,
\ldots,N$,
where $N$ is the total number of observed
samples, and $N_1 = \frac{2N}{3}$.

The estimation data is used to estimate AR-models of varying orders, using
the theory explained in Section~\ref{sec:whistletheory}. We then define the 
\textit{loss function} $W(n)$ as

\begin{equation}
    W(n) = V(\hat{\theta}^{(n)})
\end{equation}

where 

\begin{equation}
    V(\hat{\theta}^{(n)}) = \frac{1}{\val{N}}\sum^{\val{N}}_{t=1}(\val{y}(t) -
        \val{\hat{y}}(t;\hat{\theta}^{(n)}))^2
\end{equation}

where $\hat{\theta}^{(n)}$ denotes the model parameters of the $n$:th order
AR-model generated from the estimation data. This means that $W(n)$ measures
how much the validation data differs from the predicted validation data, when
using an AR-model of order $n$. By plotting $W(n)$, a
clear picture of which model order should be used; the model order at which
increasing $n$ doesn't lower $W(n)$ particularly much.

We denote quantity $\val{y}(t) - \val{\hat{y}}(t;\hat{\theta}^{(n)})$ as
$\epsilon(t;\hat{\theta}^{(n)})$. This quantity can equivalently calculated
as
\begin{equation}
    \epsilon(t;\hat{\theta}^{(n)}) =
    \frac{A(q,\hat{\theta}^{(n)})}{C(q,\hat{\theta}^{(n)})}\val{y}(t)
\end{equation}

where $A(q,\hat{\theta}^{(n)})$ denotes the poles of the AR-model, and
$C(q,\hat{\theta}^{(n)})$ the zeros. This means that
$\epsilon(t;\hat{\theta}^{(n)})$ can be calculated by filtering the validation
data with the inverse of the filter created by the estimated AR-model.

\subsubsection{Model validation}
The models can be validated by again using cross validation. Using residual
$\epsilon(t;\hat{\theta}^{(n)})$, a \textit{residual whiteness test} can be
performed. The residual should be approximately white if the model is accurate,
which can be tested by checking that the probability of
$\epsilon(t;\hat{\theta}^{(n)})$ changing sign from one sample to the next is
about 0.5.

The whiteness of the residual can also be tested by calculating it's covariance
function $R_{\epsilon\epsilon}(k)$. The function should approximately be equal
to $\lambda\delta(t)$, where $\lambda$ is some non-zero constant.

\subsubsection{Simulating}
Since a vowel is a periodic signal, it is suitable to simulate them using an
impulse train with the same period as the vowel to simulate. This pulse train
can be filtered with the estimated AR-model for a vowel to simulate it.

\subsection{Method}
The vowels `a' and `o' were recorded and trimmed such that they are two seconds
long.

\subsection{Results}
\subsection{Discussion}

\section{Assignment 3 --- GSM}

\subsection{Theory}
\subsection{Method}
\subsection{Results}
\subsection{Discussion}

\section{Conclusion}


\begin{thebibliography}{9}

\bibitem{signalproc}
  Gustafsson, Fredrik. Ljung, Lennart. Millnert, Mille.
  \textit{Signal processing}.
  Studentlitteratur, Lund,
  2010.

\end{thebibliography}
\newpage
\begin{appendices}
    \section{Matlab code}
    \subsection{sig2ar.m}\label{code:sig2ar}
    \lstinputlisting[language=Matlab]{../sig2ar.m}
    \subsection{arordercv.m}\label{code:arordercv}
    \lstinputlisting[language=Matlab]{../arordercv.m}
    \subsection{whistle.m}\label{code:whistle}
    \lstinputlisting[language=Matlab]{../whistle.m}
    \subsection{vowels.m}\label{code:vowels}
    \lstinputlisting[language=Matlab]{../vowels.m}
    \subsection{gsm.m}\label{code:gsm}
    \lstinputlisting[language=Matlab]{../gsm.m}
\end{appendices}

\end{document}
